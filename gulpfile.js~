var gulp=require("gulp");
var plumber = require("gulp-plumber");
var sass = require("gulp-sass");
var runSequence = require('run-sequence');
var browser = require("browser-sync").create();
var source = require('vinyl-source-stream');



gulp.task("browserSync", function() {
  browser.init({
    server:true,
    open:false
  });
});
gulp.task("sass", function() {
  gulp.src("scss/*.scss")
    .pipe(plumber())
    .pipe(sass())
    .pipe(gulp.dest("res/css"))
    .pipe(browser.stream());
});
gulp.task("browserify",function(){
  browserify("main.js").bundle()
    .pipe(source("bundle.js"))
    .pipe(gulp.dest("./"))
});
gulp.task("watch", function() {
  gulp.watch("res/scss/*.scss",["sass"]);
  gulp.watch("res/js/*.js", browser.reload);
  gulp.watch("res/index.html", browser.reload);
  gulp.watch("res/views/*.html", browser.reload);
  gulp.watch("server2/routes/*",["server"]);
  gulp.watch(['./*.js'], ['browserify']);
  
});
gulp.task("default", function(cb) {
  return runSequence(
    ['sass','browserSync','browserify'],
    'watch',
    cb
  );
  
});
//"$ gulp" to run "default" task
